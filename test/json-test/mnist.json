{
  "name": "lenet",
  "batch_size": 1024,
  "base_lr": 0.3,
  "l2": 1.5e-4,
  "solver_type": "sgd_with_momentum",
  "momentum": 0.9,
  "max_iter": 100,
  "test_step": 10,
  "scheduler": {
    "type": "step",
    "gama": 0.1,
    "stepsize": 1000
  },
  "data_type": "mnist",
  "train_image_file_path": "/home/linyibo/Code/my-tensor/data/train-images-idx3-ubyte",
  "train_label_file_path": "/home/linyibo/Code/my-tensor/data/train-labels-idx1-ubyte",
  "test_image_file_path": "/home/linyibo/Code/my-tensor/data/t10k-images-idx3-ubyte",
  "test_label_file_path": "/home/linyibo/Code/my-tensor/data/t10k-labels-idx1-ubyte",
  "layers": [
    {
      "name": "conv1",
      "type": "Convolution",
      "input_channels": 1,
      "output_channels": 3,
      "kernel_size": 5,
      "params": [
        {
          "name": "conv_kernel",
          "init": "he"
        },
        {
          "name": "conv_bias",
          "init": "zero"
        }
      ],
      "bottom": ["input"],
      "top": ["pooling1"]
    },
    {
      "name": "pooling1",
      "type" : "Pooling",
      "kernel_w": 2,
      "kernel_h": 2,
      "stride_w": 2,
      "stride_h": 2,
      "input_channels": 3,
      "bottom": ["conv1"],
      "top": ["relu1"]
    },
    {
      "name": "relu1",
      "type": "Relu",
      "bottom": ["pooling1"],
      "top": ["conv2"]
    },
    {
      "name": "conv2",
      "type": "Convolution",
      "input_channels": 3,
      "output_channels": 10,
      "kernel_size": 5,
      "params": [
        {
          "name": "conv_kernel",
          "init": "he"
        },
        {
          "name": "conv_bias",
          "init": "zero"
        }
      ],
      "bottom": ["relu1"],
      "top": ["pooling2"]
    },
    {
      "name": "pooling2",
      "type" : "Pooling",
      "kernel_w": 2,
      "kernel_h": 2,
      "stride_w": 2,
      "stride_h": 2,
      "input_channels": 10,
      "bottom": ["conv2"],
      "top": ["relu2"]
    },
    {
      "name": "relu2",
      "type": "Relu",
      "bottom": ["pooling2"],
      "top": ["flatten"]
    },
    {
      "name": "flatten",
      "type": "Flatten",
      "inplace": false,
      "bottom": ["relu2"],
      "top": ["linear1"]
    },
    {
      "name": "linear1",
      "type": "Linear",
      "input_feature": 490,
      "output_feature": 120,
      "params": [
        {
          "name": "linear_weight",
          "init": "xavier"
        },
        {
          "name": "linear_bias",
          "init": "constant",
          "conval": 1
        }
      ],
      "bottom": ["flatten"],
      "top": ["relu3"]
    },
    {
      "name": "relu3",
      "type": "Relu",
      "bottom": ["linear1"],
      "top": ["linear2"]
    },
    {
      "name": "linear2",
      "type": "Linear",
      "input_feature": 120,
      "output_feature": 64,
      "params": [
        {
          "name": "linear_weight",
          "init": "xavier"
        },
        {
          "name": "linear_bias",
          "init": "zero"
        }
      ],
      "bottom": ["relu3"],
      "top": ["relu4"]
    },
    {
      "name": "relu4",
      "type": "Relu",
      "bottom": ["linear2"],
      "top": ["linear3"]
    },
    {
      "name": "linear3",
      "type": "Linear",
      "input_feature": 64,
      "output_feature": 10,
      "params": [
        {
          "name": "linear_weight",
          "init": "xavier"
        },
        {
          "name": "linear_bias",
          "init": "zero"
        }
      ],
      "bottom": ["relu4"],
      "top": ["loss_with_softmax"]
    },
    {
      "name": "loss_with_softmax",
      "type": "LossWithSoftmax",
      "channels": 10,
      "bottom": ["linear3"],
      "top": ["loss"]
    },
    {
      "name": "accuracy",
      "type": "Accuracy",
      "features": 10,
      "bottom": ["linear3"],
      "top": ["accuracy"]
    }
  ]
}